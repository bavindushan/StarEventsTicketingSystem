@model StarEventsTicketingSystem.ViewModels.LoginViewModel

@{
    ViewData["Title"] = "Login - Star Events";
}

<!-- Background Wrapper -->
<div class="d-flex justify-content-center align-items-center min-vh-100 login-bg">
    <div class="card shadow-lg border-0 rounded-4" style="max-width: 600px; width: 100%; background: #fff;">
        <div class="card-body p-5">
            <!-- Header -->
            <div class="text-center mb-4">
                <i class="bi bi-box-arrow-in-right text-primary" style="font-size: 2.5rem;"></i>
                <h3 class="fw-bold mt-2 text-dark">Sign In</h3>
                <p class="text-muted small">Access your Star Events account</p>
            </div>

            <!-- Login Form -->
            <form id="loginForm" asp-action="Login" method="post" novalidate>
                <!-- Email -->
                <div class="mb-3">
                    <label asp-for="Email" class="form-label fw-semibold text-dark">
                        <i class="bi bi-envelope me-1"></i>Email
                    </label>
                    <input asp-for="Email"
                           class="form-control form-control-lg rounded-3"
                           placeholder="Enter your email"
                           autocomplete="email" />
                    <span asp-validation-for="Email" class="text-danger small"></span>
                </div>

                <!-- Password -->
                <div class="mb-3">
                    <label asp-for="Password" class="form-label fw-semibold text-dark">
                        <i class="bi bi-lock me-1"></i>Password
                    </label>
                    <div class="position-relative">
                        <input asp-for="Password"
                               type="password"
                               class="form-control form-control-lg rounded-3 pe-5"
                               placeholder="Enter your password"
                               autocomplete="current-password" />
                        <button type="button"
                                class="btn btn-link position-absolute end-0 top-50 translate-middle-y me-2 text-muted"
                                onclick="togglePassword()" style="border: none; background: none;">
                            <i class="bi bi-eye" id="toggleIcon"></i>
                        </button>
                    </div>
                    <span asp-validation-for="Password" class="text-danger small"></span>
                </div>

                <!-- Remember Me -->
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div class="form-check">
                        <input asp-for="RememberMe" class="form-check-input" />
                        <label asp-for="RememberMe" class="form-check-label small text-muted">
                            Remember me
                        </label>
                    </div>
                    <a href="#" class="small text-primary fw-semibold text-decoration-none">
                        Forgot password?
                    </a>
                </div>

                <!-- Submit -->
                <div class="d-grid">
                    <button type="submit" class="btn btn-primary btn-lg rounded-3 fw-semibold py-2">
                        <i class="bi bi-box-arrow-in-right me-1"></i> Login
                    </button>
                </div>

                <!-- Divider -->
                <div class="text-center my-4">
                    <hr class="text-muted" />
                    <span class="bg-white px-3 small text-muted position-relative" style="top:-1.5rem">
                        or continue with
                    </span>
                </div>

                <!-- Social Logins -->
                <div class="d-grid gap-2">
                    <button type="button" class="btn btn-outline-dark btn-lg rounded-3">
                        <i class="bi bi-google me-2"></i> Google
                    </button>
                    <button type="button" class="btn btn-outline-primary btn-lg rounded-3">
                        <i class="bi bi-facebook me-2"></i> Facebook
                    </button>
                </div>

                <!-- Register Link -->
                <div class="text-center mt-4">
                    <p class="text-muted small mb-0">
                        Don't have an account?
                        <a asp-action="Register" class="text-primary fw-semibold text-decoration-none">Sign up here</a>
                    </p>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Styles -->
<style>
    /* Background with image + overlay */
    .login-bg {
        background: url('/images/event-bg.jpg') no-repeat center center/cover;
        position: relative;
    }

        .login-bg::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4); /* dark overlay */
            z-index: 1;
        }

    .card {
        position: relative;
        z-index: 2;
        background: #fff !important;
    }

    .form-control:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
    }

    .btn-primary {
        background: linear-gradient(135deg, #667eea, #764ba2);
        border: none;
        transition: 0.3s;
    }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
</style>

<!-- Password Toggle -->
<script>
    function togglePassword() {
        const passwordInput = document.querySelector('input[asp-for="Password"]');
        const toggleIcon = document.getElementById('toggleIcon');
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            toggleIcon.classList.replace('bi-eye', 'bi-eye-slash');
        } else {
            passwordInput.type = 'password';
            toggleIcon.classList.replace('bi-eye-slash', 'bi-eye');
        }
    }

    // SweetAlert T&C before login submit
    document.getElementById("loginForm").addEventListener("submit", async function (e) {
        e.preventDefault(); // stop normal submit first

        const { value: accept } = await Swal.fire({
            title: "Terms and conditions",
            input: "checkbox",
            inputValue: 0,
            inputPlaceholder: "I agree with the terms and conditions",
            confirmButtonText: "Continue",
            inputValidator: (result) => {
                return !result && "You need to agree with T&C";
            }
        });

        if (accept) {
            const Toast = Swal.mixin({
                toast: true,
                position: "top-end",
                showConfirmButton: false,
                timer: 3000,
                timerProgressBar: true,
            });
            Toast.fire({
                icon: "success",
                title: "Signed in successfully"
            });

            e.target.submit();
        }
    });
</script>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
}
